---
# This playbook prepares the system to be managed by Ansible. There should be no need to call it more than once.
# Everything else should be handled via site.yml
#
# Example:
#
#   ansible-playbook -u root bootstrap-template.yml

- name: Prepare template VM to be managed by Ansible
  hosts: all
  become: false
  gather_facts: false
  vars:
    dns_server: fw.in.example.com
  roles:
    - role: robertdebock.bootstrap
      bootstrap_remote_user: root
    - { role: jkirk.user, users: [ 'jane_doe', 'john_doe' ], groupname: 'sysadmin', admin: True }
    - jkirk.template
  tasks:
    - name: Install dbus (needed for Oefenweb.hostname)
      apt:
        name: dbus
        state: present

- name: Setup hostname on template VM to be managed by Ansible
  hosts: all
  become: false
  gather_facts: false
  roles:
    - Oefenweb.hostname
